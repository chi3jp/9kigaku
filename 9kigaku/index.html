<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>九星気学 開運ナビ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <style>
    :root {
      /* メインカラー */
      --primary: #5d4037;    /* 落ち着いた茶色（土の色） */
      --secondary: #8d6e63;  /* 薄茶色（補助色） */
      --accent: #d32f2f;    /* アクセントの赤（縁起の良い色） */
      
      /* ベースカラー */
      --bg-color: #fff9f4;   /* 薄い生成り色（背景） */
      --card-bg: #ffffff;    /* 白（カード背景） */
      --text: #3e2723;       /* 濃い茶色（テキスト） */
      --text-light: #8d6e63; /* 薄い茶色（サブテキスト） */
      --border: #d7ccc8;     /* 薄いベージュ（ボーダー） */
      
      /* 九星カラー */
      --kyusei-1: #2196f3;   /* 一白水星：水色 */
      --kyusei-2: #9e9e9e;   /* 二黒土星：灰色 */
      --kyusei-3: #4caf50;   /* 三碧木星：緑 */
      --kyusei-4: #8bc34a;   /* 四緑木星：薄緑 */
      --kyusei-5: #ff9800;   /* 五黄土星：黄土色 */
      --kyusei-6: #9e9e9e;   /* 六白金星：白（グレーで代用） */
      --kyusei-7: #f44336;   /* 七赤金星：赤 */
      --kyusei-8: #9e9e9e;   /* 八白土星：白（グレーで代用） */
      --kyusei-9: #e91e63;   /* 九紫火星：紫がかったピンク */
    }
    body {
      font-family: 'Noto Sans JP', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
      line-height: 1.6;
      color: var(--text);
      background-color: var(--bg-color);
      margin: 0;
      padding: 20px;
      background-image: linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9)), 
                        url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M30,10 L50,30 L70,10 L90,30 L70,50 L90,70 L70,90 L50,70 L30,90 L10,70 L30,50 L10,30 Z" fill="none" stroke="%23d7ccc8" stroke-width="0.5"/></svg>');
      background-size: 100px 100px;
    }
    .container {
      max-width: 440px;
      margin: 2em auto;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      padding: 1.8em 1.5em 2.5em;
      border: 1px solid var(--border);
      backdrop-filter: blur(5px);
      position: relative;
      overflow: hidden;
    }
    
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--kyusei-1), var(--kyusei-2), var(--kyusei-3), var(--kyusei-4), var(--kyusei-5), var(--kyusei-6), var(--kyusei-7), var(--kyusei-8), var(--kyusei-9));
    }
    h1 {
      color: var(--primary);
      text-align: center;
      margin: 0.5em 0 1em;
      padding-bottom: 0.5em;
      font-weight: 500;
      letter-spacing: 0.1em;
      position: relative;
    }
    
    h1::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    label, input, button {
      font-size: 1em;
    }
    input[type="date"] {
      padding: 0.5em 0.8em;
      border: 1px solid var(--border);
      border-radius: 6px;
      margin-right: 10px;
      background: white;
      color: var(--text);
      font-family: inherit;
      transition: all 0.3s ease;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    
    input[type="date"]:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(211, 47, 47, 0.2);
    }
    button, input[type="button"], input[type="submit"] {
      border-radius: 50px;
      background: linear-gradient(135deg, var(--accent), #f06292);
      color: white;
      border: none;
      padding: 0.5em 1.5em;
      margin-left: 0.5em;
      cursor: pointer;
      font-weight: 500;
      letter-spacing: 0.03em;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(211, 47, 47, 0.3);
    }
    
    button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }
    
    button:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .tabs {
      display: flex;
      margin: 0 -1.5em 1.5em;
      border-bottom: 1px solid var(--border);
      padding: 0 1.5em;
    }
    .tab-btn {
      flex: 1;
      border: none;
      background: transparent;
      color: var(--text-light);
      padding: 0.8em 0.5em;
      font-size: 0.95em;
      font-weight: 500;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
      letter-spacing: 0.05em;
    }
    .tab-btn.active {
      color: var(--accent);
      font-weight: 600;
    }
    
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent);
      border-radius: 2px 2px 0 0;
    }
    .tab-content {
      display: none;
      background: var(--card-bg);
      border-radius: 0 0 10px 10px;
      min-height: 80px;
      padding: 1.1em 0.4em;
      border: none;
    }
    .tab-content.active {
      display: block;
    }
    .fortune-block {
      background: white;
      border-radius: 12px;
      padding: 1.8em;
      margin-bottom: 1.5em;
      box-shadow: 0 3px 15px rgba(0, 0, 0, 0.03);
      border: 1px solid var(--border);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .fortune-block:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
    }
    .fortune-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.2em;
      padding-bottom: 1em;
      border-bottom: 1px dashed var(--border);
    }
    .fortune-date {
      color: var(--text-light);
      font-size: 0.9em;
      letter-spacing: 0.05em;
    }
    .fortune-score {
      background: linear-gradient(135deg, var(--accent), #f06292);
      color: white;
      padding: 0.3em 1em;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(211, 47, 47, 0.3);
      position: relative;
      overflow: hidden;
    }
    .fortune-content {
      margin: 1.2em 0;
      line-height: 1.7;
    }
    .fortune-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1em;
      margin: 1.5em 0 0.5em;
    }
    .detail-card {
      background: #fcfcfc;
      padding: 1.2em 0.8em;
      border-radius: 10px;
      text-align: center;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    .detail-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .detail-card i {
      display: block;
      font-size: 2em;
      margin-bottom: 0.6em;
      opacity: 0.8;
    }
    .detail-card .label {
      font-size: 0.8em;
      color: var(--text-light);
      margin-bottom: 0.5em;
      letter-spacing: 0.05em;
    }
    .detail-card .value {
      font-weight: 600;
      color: var(--primary);
      font-size: 1.1em;
    }
    .super-lucky {
      display: inline-flex;
      align-items: center;
      margin-top: 1em;
      padding: 0.5em 1.2em;
      background: linear-gradient(135deg, #ff6b6b, #ff8e53);
      color: white;
      border-radius: 50px;
      font-size: 0.9em;
      font-weight: 600;
      animation: pulse 2s infinite;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .super-lucky::before {
      content: '✨';
      margin-right: 0.5em;
      animation: twinkle 1.5s infinite;
    }
    .fortune-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 15px;
      margin-top: 1.2em;
    }
    ul { margin: 0; padding: 0; list-style: none; }
    .fortune-tips {
      margin-top: 1.5em;
      padding-top: 1.2em;
      border-top: 1px dashed #e0e0e0;
    }
    .fortune-tips h4 {
      margin: 0 0 0.8em 0;
      color: #52766a;
      display: flex;
      align-items: center;
    }
    .fortune-tips h4::before {
      content: '💡';
      margin-right: 0.5em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>九星気学 開運ナビ</h1>
    <div class="input-area" style="text-align:center;margin-bottom:1em;">
      <label for="birthdate">生年月日：</label>
      <input type="date" id="birthdate"/>
      <button id="setBirth">決定</button>
      <button id="resetBirth">リセット</button>
    </div>
    <div id="result"></div>
    <div class="tabs">
      <button class="tab-btn active" data-tab="tab-daily">日</button>
      <button class="tab-btn" data-tab="tab-weekly">週</button>
      <button class="tab-btn" data-tab="tab-glossary">用語解説</button>
    </div>
    <div id="tab-daily" class="tab-content active"></div>
    <div id="tab-weekly" class="tab-content"></div>
    <div id="tab-glossary" class="tab-content">
      <ul>
        <li><b>本命星：</b>生まれ年から導かれるあなたの九星</li>
        <li><b>吉方位：</b>運を高める方角。<br>カレンダーや運勢欄でチェック</li>
        <li><b>ラッキーカラー／アイテム：</b>その日・週に縁起の良い色や物</li>
        <li><b>特に運気の良い日：</b>本命星と方位が重なり強運日になる日</li>
      </ul>
    </div>
  </div>
  <script>
    // 九星ロジック・運勢データ
    // 九星の配列（1900年基準）
    const kyuseiTable = [1,9,8,7,6,5,4,3,2];
    
    // 九星の相性（吉方位）テーブル
    const luckyDirections = {
      1: [4, 6, 8],  // 一白水星：東南、南西、北東
      2: [1, 3, 7],  // 二黒土星：北、東、西
      3: [2, 4, 8],  // 三碧木星：南、東南、北東
      4: [1, 3, 9],  // 四緑木星：北、東、南東
      5: [1, 3, 5, 7, 9], // 五黄土星：全ての方位（中央を除く）
      6: [2, 6, 8],  // 六白金星：南、南西、北東
      7: [2, 4, 9],  // 七赤金星：南、東南、南東
      8: [1, 6, 9],  // 八白土星：北、南西、南東
      9: [3, 7, 8]   // 九紫火星：東、西、北東
    };
    
    // 方位の日本語名
    const directionNames = [
      '',           // 0番目は未使用
      '北',         // 1
      '南',         // 2
      '東',         // 3
      '東南',       // 4
      '南西',       // 5
      '南西',       // 6（五黄土星用に重複）
      '西',         // 7
      '北東',       // 8
      '南東'        // 9
    ];
    
    // 本命星を取得
    function getKyusei(year) {
      const idx = (year - 1900) % 9;
      return kyuseiTable[idx < 0 ? idx + 9 : idx];
    }
    function kyuseiName(n) {
      return ["一白水星","二黒土星","三碧木星","四緑木星","五黄土星","六白金星","七赤金星","八白土星","九紫火星"][n-1];
    }
    const luckyColorList = ["藍色","抹茶色","朱色","生成り","金茶","深緑","桜色","群青","白"];
    const luckyItemList = ["和紙のメモ","風呂敷","扇子","木の置物","組紐ストラップ","湯呑み","招き猫","お箸","手ぬぐい"];
    // 九星気学の正式な方位表記
    // 0: 東, 1: 西, 2: 南, 3: 北, 4: 南東, 5: 南西, 6: 北東, 7: 北西, 8: 中央
    const directionList = ["東","西","南","北","南東","南西","北東","北西","中央"];
    // 月盤の吉方位を取得
    function getMonthlyDirections(kyusei) {
      return luckyDirections[kyusei] || [];
    }
    
    // 九星の日盤テーブル（月ごとの九星の配置）
    const dailyKyuseiTable = {
      // 月: [1日, 2日, 3日, ... 31日]
      1: [8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2],
      2: [3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4],
      3: [5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8],
      4: [2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4],
      5: [5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8],
      6: [2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4],
      7: [5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8],
      8: [2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5],
      9: [5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7],
      10: [2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5],
      11: [5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7],
      12: [2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,1,2,3,4,5]
    };
    
    // 日盤の吉方位を取得（九星気学に基づく実装）
    function getDailyDirections(date) {
      const day = date.getDate() - 1; // 0-based
      const month = date.getMonth() + 1;
      
      // その日の九星を取得
      const dailyKyusei = dailyKyuseiTable[month]?.[day] || 1;
      
      // 日盤の九星に基づく吉方位（月盤とは異なるロジック）
      // 各九星ごとに3つの吉方位を設定（重複なし）
      const dailyLuckyDirections = {
        1: [4, 6, 8],  // 一白水星: 南東, 南西, 北東
        2: [3, 7, 9],  // 二黒土星: 東, 西, 南東
        3: [1, 5, 7],  // 三碧木星: 北, 南西, 西
        4: [2, 6, 9],  // 四緑木星: 南, 南西, 南東
        5: [1, 3, 8],  // 五黄土星: 北, 東, 北東
        6: [2, 4, 8],  // 六白金星: 南, 南東, 北東西
        7: [2, 4, 9],  // 七赤金星: 南, 南東, 南東（※九星による）
        8: [1, 3, 6],  // 八白土星: 北, 東, 南西
        9: [2, 4, 7]   // 九紫火星: 南, 南東, 西
      };
      
      // 重複を防ぐため、配列をコピーして返す
      return [...new Set(dailyLuckyDirections[dailyKyusei] || [3, 4, 8])];
    }
    
    // 特別な方位かどうかを判定（月盤と日盤の重なり）
    function isSpecialDirection(monthlyDirs, dailyDirs, dir) {
      return monthlyDirs.includes(dir) && dailyDirs.includes(dir);
    }
    
    // 方位を日本語の文字列に変換
    function formatDirections(dirs) {
      return dirs.map(dir => directionNames[dir] || '').filter(Boolean).join('・');
    }
    
    // 運勢データを取得
    function getSampleFortune(date, kyusei) {
      const d = new Date(date);
      const day = d.getDate();
      const month = d.getMonth() + 1;
      const base = (day + kyusei) % 9;
      
      // 月盤と日盤の吉方位を取得
      const monthlyDirs = getMonthlyDirections(kyusei);
      const dailyDirs = getDailyDirections(d);
      
      // 特別な方位（月盤と日盤で重なる方位）
      const specialDirs = monthlyDirs.filter(dir => dailyDirs.includes(dir));
      
      // 特別な日かどうかを判定（より厳格な条件に）
      // 1. 月の特定の日（1日、11日、21日）
      // 2. かつ、特別な方位が2つ以上重なる日
      // 3. または、1月1日のみ特別な日として扱う
      const isSpecialDay = 
        ((day === 1 || day === 11 || day === 21) && specialDirs.length >= 2) ||
        (month === 1 && day === 1); // 元旦のみ特別
      
      // メインの吉方位（日盤の最初の吉方位を使用）
      const mainDirection = dailyDirs.length > 0 ? dailyDirs[0] : 1;
      
      // 日付に基づいて一貫したスコアを生成（60-100の範囲）
      const score = 60 + (day * month + kyusei) % 41;
      
      // 運勢メッセージのベース（日付に基づいて一貫性を持たせる）
      const fortuneIndex = (day + month * 31 + kyusei) % 9;
      const fortunes = [
        "物事がスムーズに進みやすい日。",
        "周囲との調和がポイントに。",
        "ひらめきに恵まれる日です。",
        "自分の直感を信じてみて。",
        "休息とリフレッシュが大切。",
        "感謝の気持ちを表現すると吉。",
        "思い切ってチャレンジして吉。",
        "助け合いが運気アップの鍵。",
        "小さな幸せを大切に。"
      ];
      
      // 特別な日は運勢メッセージを強化
      const fortuneBase = isSpecialDay ? 
        [
          "今日は運気が最高潮！新しいことを始めるのに最適な日です。",
          "大きな決断や重要な行動に適した日。思い切った一歩を。",
          "人との出会いが運を引き寄せる一日。積極的に交流を。",
          "願い事が叶いやすい日。ポジティブな気持ちで過ごして。",
          "チャンスが巡ってくる日。アンテナを張っておきましょう。"
        ][(day + month) % 5] : 
        fortunes[fortuneIndex];
      
      return {
        fortune: fortuneBase,
        color: luckyColorList[(base + kyusei) % luckyColorList.length],
        item: luckyItemList[(base * 2 + kyusei) % luckyItemList.length],
        direction: directionNames[mainDirection] || '北',
        monthlyDirections: monthlyDirs.map(dir => ({
          dir,
          name: directionNames[dir] || '',
          isSpecial: isSpecialDirection(monthlyDirs, dailyDirs, dir)
        })),
        dailyDirections: dailyDirs.map(dir => ({
          dir,
          name: directionNames[dir] || '',
          isSpecial: isSpecialDirection(monthlyDirs, dailyDirs, dir)
        })),
        specialDirections: specialDirs.map(dir => ({
          dir,
          name: directionNames[dir] || ''
        })),
        superLucky: isSpecialDay
      };
    }
    function yyyymmdd(d) { return d.toISOString().split('T')[0]; }

    function renderAllTabs() {
      const bd = localStorage.getItem("birthdate");
      const dailyTab = document.getElementById("tab-daily");
      const weeklyTab = document.getElementById("tab-weekly");
      if(!bd) {
        document.getElementById("result").innerHTML = "<b>生年月日を入力してください。</b>";
        dailyTab.innerHTML = "";
        weeklyTab.innerHTML = "";
        return;
      }
      const year = Number(bd.split("-")[0]);
      const kyuseiNum = getKyusei(year);
      const kyusei = kyuseiName(kyuseiNum);
      document.getElementById("result").innerHTML = `あなたの本命星は <b>${kyusei}</b>（${year}年生まれ）です。`;

      // 日運
      const d = new Date();
      const f = getSampleFortune(yyyymmdd(d), kyuseiNum);
      const dayOfWeek = ['日', '月', '火', '水', '木', '金', '土'][d.getDay()];
      const score = 60 + (d.getDate() * (d.getMonth() + 1) + kyuseiNum) % 41; // 日付に基づく一貫したスコア（60-100）
      const tips = [
        "朝の時間を有効に使うと良い結果が得られそうです。",
        "新しい出会いを大切にすると運気が上昇します。",
        "自然に触れることでリフレッシュできる一日です。",
        "感謝の気持ちを伝えると良いことが起こりそうです。",
        "小さな親切が大きな幸運を呼び込む一日です。"
      ][(d.getDate() + (d.getMonth() + 1) * 31 + kyuseiNum) % 5]; // 日付に基づく一貫した開運アドバイス
      
      dailyTab.innerHTML = `
          <div class="fortune-header">
            <div>
              <div class="fortune-date">${d.getFullYear()}年${d.getMonth() + 1}月${d.getDate()}日（${dayOfWeek}）</div>
              <h3 style="margin: 0.2em 0 0; color: #23403b;">今日の運勢</h3>
            </div>
            <div class="fortune-score">運勢スコア ${score}点</div>
          </div>
          
        <div class="fortune-content">
            <p style="margin: 0; font-size: 1.05em;">${f.fortune}</p>
            
            <div class="fortune-details">
              <div class="detail-card">
                <i>🎨</i>
                <div class="label">ラッキーカラー</div>
                <div class="value">${f.color}</div>
              </div>
              <div class="detail-card">
                <i>🎁</i>
                <div class="label">ラッキーアイテム</div>
                <div class="value">${f.item}</div>
              </div>
              <div class="detail-card">
                <i>🧭</i>
                <div class="label">吉方位</div>
                <div class="value">
                  ${Array.from(new Set(f.monthlyDirections.map(d => d.dir))).map(dir => {
                    const dirObj = f.monthlyDirections.find(d => d.dir === dir);
                    const isSpecial = f.specialDirections.some(sd => sd.dir === dir);
                    return `<span style="${isSpecial ? 'color: #e91e63; font-weight: bold;' : ''}">
                      ${directionNames[dir]}${isSpecial ? '★' : ''}
                    </span>`;
                  }).join('・')}
                </div>${f.specialDirections.length > 0 ? `
                  <div style="font-size:0.8em; color:#e91e63; margin-top:4px;">
                    ${f.specialDirections.length > 0 ? `★ 特別方位: ${Array.from(new Set(f.specialDirections.map(d => d.name))).join('・')}` : ''}
                  </div>
                ` : ''}
              </div>
              <div class="detail-card">
                <i>⏰</i>
                <div class="label">ラッキータイム</div>
                <div class="value">${['10:00-11:00', '14:00-15:00', '16:00-17:00'][Math.floor(Math.random() * 3)]}</div>
              </div>
            </div>
            
            ${f.superLucky ? `
              <div class="super-lucky">
                今日は特別に運気が良い日！大きな決断や新しいことに挑戦するのに最適です。
              </div>
            ` : ''}
            
            <div class="fortune-tips">
              <h4>今日の開運アドバイス</h4>
              <p style="margin: 0.5em 0 0; color: #555; line-height: 1.6;">
                ${[
                  '朝の時間を有効に使うと良い結果が得られそうです。',
                  '新しい出会いを大切にすると運気が上昇します。',
                  '自然に触れることでリフレッシュできる一日です。',
                  '感謝の気持ちを伝えると良いことが起こりそうです。',
                  '小さな親切が大きな幸運を呼び込む一日です。'
                ][Math.floor(Math.random() * 5)]}
              </p>
            </div>
          </div>
        </div>
      `;

      // 週運
      let html = '<b>今週の運勢（明日〜6日後）</b>';
      for(let i=1;i<=6;i++) {
        const dt = new Date();
        dt.setDate(dt.getDate()+i);
        const ff = getSampleFortune(yyyymmdd(dt), kyuseiNum);
        html += `
          <div class="fortune-block">
            <b>${yyyymmdd(dt)}</b>
            <p>${ff.fortune}</p>
            <ul>
              <li>ラッキーカラー：${ff.color}</li>
              <li>ラッキーアイテム：${ff.item}</li>
              <li>吉方位：${ff.direction}</li>
            </ul>
            ${ff.superLucky ? '<div class="super-lucky">特に運気が良い日！</div>' : ''}
          </div>
        `;
      }
      weeklyTab.innerHTML = html;
    }

    document.addEventListener("DOMContentLoaded", function(){
      const birthInput = document.getElementById("birthdate");
      const bd = localStorage.getItem("birthdate");
      if(bd) birthInput.value = bd;
      renderAllTabs();

      document.getElementById("setBirth").onclick = function(){
        const v = birthInput.value;
        if(v) {
          localStorage.setItem("birthdate", v);
          renderAllTabs();
        }
      };
      document.getElementById("resetBirth").onclick = function(){
        localStorage.removeItem("birthdate");
        birthInput.value = "";
        renderAllTabs();
      };

      // タブ切替
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.onclick = function(){
          document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
          this.classList.add('active');
          document.querySelectorAll('.tab-content').forEach(tab=>tab.classList.remove('active'));
          document.getElementById(this.dataset.tab).classList.add('active');
        };
      });
    });
  </script>
</body>
</html>
